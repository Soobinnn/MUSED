<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD Sql Map 2.0//EN"
'http://ibatis.apache.org/dtd/sql-map-2.dtd'>
<sqlMap namespace="talent">
<typeAlias alias="talent" type="talent.talentVO"/>
<!-- <typeAlias type="talent.imgVO" alias="image"/>
	<resultMap class="image" id="imageRes">
		<result column="no_p" property="no_p"/>
		<result column="main_image" property="main_image"/>
		<result column="image2" property="image2"/>
		<result column="image3" property="image3"/>
		<result column="image4" property="image4"/>
		<result column="image5" property="image5"/>

	</resultMap>
 -->	
	<resultMap class="talent" id="talentRes">
		<result property="talent_no" column="talent_no"/>
		<result property="talent_id" column="talent_id"/>
		<result property="talent_state" column="talent_state"/>
		<result property="talent_subject" column="talent_subject"/>
		<result property="talent_name" column="talent_name"/>
		<result property="talent_category" column="talent_category"/>
		<result property="talent_price" column="talent_price"/>
		<result property="talent_phone" column="talent_phone"/>
		<result property="talent_sido" column="talent_sido"/>
		<result property="talent_gogon" column="talent_gogon"/>
		<result property="talent_content" column="talent_content"/>	
		<result property="talent_image" column="talent_image"/>		
		<result property="main_img" column="main_img"/>		
	</resultMap>

	<!-- talent 전체 정보 가져오기 -->
	<sql id="select-all">
		SELECT * FROM TALENT 
	</sql>
	
	<!-- where no 설정 -->
	<sql id="where-no">
		WHERE talent_no=#talent_no#
	</sql>
	
	<!-- TALENT 전체 가져오는데 no정렬 -->
	<select id="selectAll" resultMap="talentRes">
		SELECT * FROM TALENT
		ORDER BY talent_no DESC
	</select>
	
	<select id="selectLastNo" resultMap="talentRes">
		select * TALENT where talent_no = (select max(talent_no) from TALENT) 
	</select>

	
	<!-- 	talent 일정 no의 전체 정보 가져오기	 -->
	<select id="selectOne" resultMap="talentRes" parameterClass="int">
		<include refid="select-all"/>
		<include refid="where-no"/>
	</select>

	<!--talent 상품 등록을 위한 insert -->
 	<insert id="insertTalent" parameterClass="talent">
		INSERT INTO TALENT (TALENT_NO, TALENT_ID, TALENT_STATE, TALENT_SUBJECT, TALENT_NAME, TALENT_CATEGORY, TALENT_PRICE, TALENT_PHONE, TALENT_SIDO, TALENT_GOGON, TALENT_CONTENT, TALENT_IMAGE,MAIN_IMG)
		VALUES (TALENT_NO_SEQ.NEXTVAL, #talent_id#, #talent_state#, #talent_subject#, #talent_name#, #talent_category#, #talent_price#, #talent_phone#, #talent_sido#, #talent_gogon#, #talent_content#, #talent_image#,#main_img#)
	</insert>
 	<!-- talent 상품 수정을 위한 update --> 
	<update id="updateTalent" parameterClass="talent">
		UPDATE TALENT SET TALENT_STATE = #talent_state#, TALENT_SUBJECT=#talent_subject#, TALENT_NAME = #talent_name#, TALENT_CATEGORY = #talent_category#, TALENT_PRICE = #talent_price#, TALENT_PHONE = #talent_phone#, TALENT_SIDO=#talent_sido#, TALENT_GOGON=#talent_gogon#, TALENT_CONTENT = #talent_content#, TALENT_IMAGE = #talent_image#, MAIN_IMG=#main_img#
		<include refid="where-no"/>
	</update>

	<!-- talent 상품 삭제를 위한 delete	 -->
	<delete id="deleteTalent" parameterClass="talent">
		DELETE FROM TALENT
		<include refid="where-no"/>
	</delete>
 
 	<!-- 검색로직 추가시작 -->
	<select id="main_selectSearch" resultMap="talentRes" parameterClass="string">
	<include refid="select-all" />
		 	WHERE talent_content LIKE #searchKeyword# OR talent_subject LIKE #searchKeyword#
			ORDER BY talent_no DESC
		</select>
	<!-- 검색로직 끝 -->
</sqlMap>